@model IEnumerable<EmployeeManagementPortal.MVC.ViewModels.EmployeeViewModel>

@{
    ViewData["Title"] = "Employees List";
}

<h1>Employee Details</h1>
<br /> 

<div class="row">
    <div class="col-10">
        <form class="form-inline my-2 my-lg-0" asp-action="search" asp-controller="Employee">
            <input class="form-control mr-sm-2" name="searchTerm" type="search" placeholder="search" aria-label="search" />
            <button class="btn btn-outline-success my-2 my-sm-0" type="submit">search</button>
        </form>
    </div>
    <div class="col-2">
        <p><a asp-action="Create" class="btn btn-primary">Add Empolyee</a></p>
    </div>
</div>

<br />
<script>

    function RemoveEmployee(_e) {
        var url = "Employee/Delete";
        var employeeId = $(_e).attr('asp-route-id');
        var result = confirm("Are you sure you want to delete the employee?")
        if (result == true) {
            window.location.href = url;
        }
        else {
            window.location.reload();
        }

        //if (result == true) {
        //    $.ajax({
        //        url: url,
        //        data: { employeeId: employeeId },
        //        type: "GET",
        //        success: function (data) {
        //            //reload the page
        //            window.location.reload();
        //        },
        //        error: function (error) { }
        //    });
        //}
        //else {

        //}
    }
</script>
<table class="table table-bordered">
    <thead>
        <tr>
              <th>
                @Html.DisplayNameFor(model => model.FullName)
            </th>
            <th>
                @Html.DisplayName("Role")
            </th>
            <th>
                @Html.DisplayNameFor(model => model.MobileNo)
            </th>
            <th>
                @Html.DisplayName("Actions")
            </th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.FullName)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.EmployeeRoleName)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.MobileNo)
                </td>
                <td>
                    <a asp-action="Details" asp-controller="Employee" asp-route-id="@item.EmployeeId" class="btn btn-info">Details</a>
                    <a asp-action="Edit" asp-controller="Employee" asp-route-id="@item.EmployeeId" class="btn btn-warning">Edit</a>
                    <a asp-route-id="@item.EmployeeId" class="btn btn-danger" onclick="RemoveEmployee(this)">Delete</a>
                </td>
            </tr>
        }
    </tbody>
</table>
